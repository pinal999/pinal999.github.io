<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Telegram Web App Demo</title>
    <script src="https://telegram.org/js/telegram-web-app.js?1"></script>
    <script>
        function setThemeClass() {
            document.documentElement.className = Telegram.WebApp.colorScheme;
        }

        Telegram.WebApp.onEvent('themeChanged', setThemeClass);
        setThemeClass();

        const DemoApp = {
            sendTextAndClose() {
                const textField = document.querySelector('#text_field');
                const text = textField.textContent.trim();
                if (!text) return textField.focus();

                if (new Blob([text]).size > 4096) {
                    return alert('Text is too long');
                }

                Telegram.WebApp.sendData(text);
                Telegram.WebApp.close();
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            document.body.style.visibility = '';
            Telegram.WebApp.ready();

            // Setup Main Button
            Telegram.WebApp.MainButton.setParams({
                text: 'SEND TEXT AND CLOSE WEBVIEW',
                is_visible: true
            }).onClick(DemoApp.sendTextAndClose);
        });
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        #text_field {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px 0;
            min-height: 50px;
        }
    </style>
</head>
<body style="visibility: hidden;">
<section>
    <div contenteditable="true" id="text_field" placeholder="Input text here..."></div>
</section>
</body>
</html>
