<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Telegram Web App Demo</title>
    <script src="https://telegram.org/js/telegram-web-app.js?1"></script>
    <script>
        function setThemeClass() {
            document.documentElement.className = Telegram.WebApp.colorScheme;
        }

        Telegram.WebApp.onEvent('themeChanged', setThemeClass);
        setThemeClass();

        const DemoApp = {
            sendText() {
                const textField = document.querySelector('#text_field');
                const text = textField.textContent.trim();
                if (!text) return textField.focus();

                if (new Blob([text]).size > 4096) {
                    return alert('Text is too long');
                }

                Telegram.WebApp.sendData(text);
            },

            sendTime() {
                Telegram.WebApp.sendData(new Date().toString());
            },

            sendMessage(msg_id = '', with_webview = false) {
                const queryId = Telegram.WebApp.initDataUnsafe?.query_id;
                if (!queryId) {
                    return alert('WebViewQueryId not defined');
                }

                const btnStatus = document.querySelector('#btn_status');
                btnStatus.textContent = 'Sending...';
                btnStatus.style.display = 'block';

                // Dummy response to simulate API request
                setTimeout(() => {
                    btnStatus.textContent = 'Message sent successfully!';
                }, 1000);
            },

            // Alerts
            showAlert(message) {
                Telegram.WebApp.showAlert(message);
            },
            showConfirm(message) {
                Telegram.WebApp.showConfirm(message);
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            document.body.style.visibility = '';
            Telegram.WebApp.ready();
        });
    </script>
</head>
<body style="visibility: hidden;">
<section>
    <button id="send_text_btn" onclick="DemoApp.sendText();">Send Text</button>
    <button id="send_time_btn" onclick="DemoApp.sendTime();">Send Time</button>
    <button id="send_message_btn" onclick="DemoApp.sendMessage();">Send Message</button>
    <div id="btn_status" style="display:none;"></div>
    <div contenteditable="true" id="text_field" placeholder="Input text here..."></div>

    <p>Test alerts:</p>
    <div class="columns">
        <ul>
            <li><a href="javascript:;" onclick="alert('Hello!');">alert</a></li>
            <li><a href="javascript:;" onclick="confirm('Are you sure?');">confirm</a></li>
            <li><a href="javascript:;" onclick="prompt('How old are you?');">prompt</a></li>
        </ul>
        <ul>
            <li><a href="javascript:;" onclick="DemoApp.showAlert('Hello!');">showAlert</a></li>
            <li><a href="javascript:;" onclick="DemoApp.showConfirm('Are you sure?');">showConfirm</a></li>
        </ul>
    </div>
</section>
</body>
</html>
